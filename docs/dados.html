<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 4 Dados | Doutorado</title>
  <meta name="description" content="Template de relatório." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 4 Dados | Doutorado" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Template de relatório." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 4 Dados | Doutorado" />
  
  <meta name="twitter:description" content="Template de relatório." />
  

<meta name="author" content="Julio Trecenti" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="captchas.html"/>
<link rel="next" href="modelo.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="assets/css/bookdown.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tese</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Sobre este documento</a></li>
<li class="chapter" data-level="2" data-path="introducao.html"><a href="introducao.html"><i class="fa fa-check"></i><b>2</b> Introdução</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introducao.html"><a href="introducao.html#objetivos"><i class="fa fa-check"></i><b>2.1</b> Objetivos</a></li>
<li class="chapter" data-level="2.2" data-path="introducao.html"><a href="introducao.html#justificativa"><i class="fa fa-check"></i><b>2.2</b> Justificativa</a></li>
<li class="chapter" data-level="2.3" data-path="introducao.html"><a href="introducao.html#hipóteses"><i class="fa fa-check"></i><b>2.3</b> Hipóteses</a></li>
<li class="chapter" data-level="2.4" data-path="introducao.html"><a href="introducao.html#organização-do-trabalho"><i class="fa fa-check"></i><b>2.4</b> Organização do trabalho</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="captchas.html"><a href="captchas.html"><i class="fa fa-check"></i><b>3</b> Captchas</a>
<ul>
<li class="chapter" data-level="3.1" data-path="captchas.html"><a href="captchas.html#força-bruta"><i class="fa fa-check"></i><b>3.1</b> Força-bruta</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="captchas.html"><a href="captchas.html#redes-neurais"><i class="fa fa-check"></i><b>3.1.1</b> Redes neurais</a></li>
<li class="chapter" data-level="3.1.2" data-path="captchas.html"><a href="captchas.html#a-operação-de-convolução"><i class="fa fa-check"></i><b>3.1.2</b> A operação de convolução</a></li>
<li class="chapter" data-level="3.1.3" data-path="captchas.html"><a href="captchas.html#redes-neurais-convolucionais"><i class="fa fa-check"></i><b>3.1.3</b> Redes neurais convolucionais</a></li>
<li class="chapter" data-level="3.1.4" data-path="captchas.html"><a href="captchas.html#resultados"><i class="fa fa-check"></i><b>3.1.4</b> Resultados</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dados.html"><a href="dados.html"><i class="fa fa-check"></i><b>4</b> Dados</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dados.html"><a href="dados.html#simulações"><i class="fa fa-check"></i><b>4.1</b> Simulações</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="dados.html"><a href="dados.html#primeiro-passo-modelo-inicial"><i class="fa fa-check"></i><b>4.1.1</b> Primeiro passo: modelo inicial</a></li>
<li class="chapter" data-level="4.1.2" data-path="dados.html"><a href="dados.html#segundo-passo-dados"><i class="fa fa-check"></i><b>4.1.2</b> Segundo passo: dados</a></li>
<li class="chapter" data-level="4.1.3" data-path="dados.html"><a href="dados.html#terceiro-passo-modelo-final"><i class="fa fa-check"></i><b>4.1.3</b> Terceiro passo: modelo final</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelo.html"><a href="modelo.html"><i class="fa fa-check"></i><b>5</b> Modelagem</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelo.html"><a href="modelo.html#construcao"><i class="fa fa-check"></i><b>5.1</b> Construção dos dados</a></li>
<li class="chapter" data-level="5.2" data-path="modelo.html"><a href="modelo.html#heuristica"><i class="fa fa-check"></i><b>5.2</b> Modelagem usando heurísticas</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="modelo.html"><a href="modelo.html#heurística-1-substituição-da-pior-predição"><i class="fa fa-check"></i><b>5.2.1</b> Heurística 1: substituição da pior predição</a></li>
<li class="chapter" data-level="5.2.2" data-path="modelo.html"><a href="modelo.html#heurística-2-substituição-da-predição-com-menor-diferença-para-segunda-candidata"><i class="fa fa-check"></i><b>5.2.2</b> Heurística 2: substituição da predição com menor diferença para segunda candidata</a></li>
<li class="chapter" data-level="5.2.3" data-path="modelo.html"><a href="modelo.html#heurística-3-substituição-da-predição-que-tem-maior-entropia-no-vetor-de-predições"><i class="fa fa-check"></i><b>5.2.3</b> Heurística 3: substituição da predição que tem maior entropia no vetor de predições</a></li>
<li class="chapter" data-level="5.2.4" data-path="modelo.html"><a href="modelo.html#propriedades-da-estratégia"><i class="fa fa-check"></i><b>5.2.4</b> Propriedades da estratégia</a></li>
<li class="chapter" data-level="5.2.5" data-path="modelo.html"><a href="modelo.html#resultados-empíricos"><i class="fa fa-check"></i><b>5.2.5</b> Resultados empíricos</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modelo.html"><a href="modelo.html#veross"><i class="fa fa-check"></i><b>5.3</b> Modelagem usando verossimilhança</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelo.html"><a href="modelo.html#resultados-empíricos-1"><i class="fa fa-check"></i><b>5.3.1</b> Resultados empíricos</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="modelo.html"><a href="modelo.html#implementação"><i class="fa fa-check"></i><b>5.4</b> Implementação</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusao.html"><a href="conclusao.html"><i class="fa fa-check"></i><b>6</b> Conclusões</a></li>
<li class="appendix"><span><b>Apêndice</b></span></li>
<li class="chapter" data-level="A" data-path="pacote-captcha.html"><a href="pacote-captcha.html"><i class="fa fa-check"></i><b>A</b> Pacote {captcha}</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Doutorado</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dados" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Capítulo 4</span> Dados<a href="dados.html#dados" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Neste capítulo, descrevemos em detalhes como foi a obtenção dos dados para a realização da pesquisa. Como comentado anteriormente, a base foi construída do zero para os fins do projeto, sendo uma parte significativa dos esforços para obtenção dos achados.</p>
<p>No total, foram construídas bases de dados de dez Captchas que estavam disponíveis publicamente no momento da realização da pesquisa. Os Captchas foram revisados pela última vez no dia 14/02/2022, para verificar se ainda estavam ativos.</p>
<p>Para selecionar os Captchas, adotamos alguns critérios objetivos. Os critérios foram:</p>
<ol style="list-style-type: decimal">
<li>O site acessado é de um serviço público (governo federal, tribunais, etc).</li>
<li>Trata-se de um Captcha contendo letras (A a Z) e números (0 a 9) em uma imagem com extensão jpeg ou png.</li>
<li>O comprimento do Captcha é fixo, ou seja, dois Captchas da mesma origem devem ter sempre o mesmo comprimento.</li>
</ol>
<p>A primeira restrição para escolha dos Captchas é de ordem principiológica. Um serviço público não deveria restringir o acesso aos dados para robôs. Como já discutido anteriormente, nesses casos, a existência do Captcha não tem como finalidade dar maior segurança ao serviço prestado, mas sim limitar o acesso aos servidores por robôs.</p>
<p>As restrições 2 e 3 foram escolhidas com o objetivo de facilitar as simulações para obtenção dos resultados. Em princípio, nada impede que os modelos desenvolvidos trabalhem com outros tipos de rótulos, desde que exista uma lista prévia de rótulos. Além disso, é possível realizar adaptações no pré-processamento base de dados para lidar com diferentes comprimentos de Captchas.</p>
<p>A Tabela <a href="#tab:lista-captcha"><strong>??</strong></a> mostra os Captchas trabalhados. A informação de limite de chutes é importante para a implementação do oráculo, detalhado a seguir.</p>
<p>O oráculo é o nome que escolhemos para a possibilidade de checar, de forma automática, se uma predição do modelo foi bem ou mal sucedida. Como um Captcha é um teste de Turing inverso, por definição ele é obrigado a mencionar se uma predição está correta: se a predição foi correta, a página de interesse é acessada; se a predição está incorreta, o site envia uma mensagem de erro.</p>
<p>Para implementar um oráculo em uma linguagem de programação, é necessário seguir os seguintes passos:</p>
<ol style="list-style-type: decimal">
<li>Acessar a página do site de interesse</li>
<li>Preencher o formulário de pesquisa com a informação a ser consultada. Por exemplo, no site da RFB, a informação é o CNPJ da empresa a ser consultada. Em um site de tribunal, a informação é um número identificador de processo.</li>
<li>Baixar o Captcha da busca.</li>
<li>Aplicar o modelo no Captcha baixado (ou classificar a imagem manualmente) para obter a predição.</li>
<li>Submeter a consulta no site, informando a predição.</li>
<li>Verificar o resultado. Se acessou a página desejada, a predição está correta. Caso contrário, a predição está incorreta.</li>
</ol>
<p>Outra oportunidade que o oráculo permite em parte dos casos é a possibilidade de testar mais de uma predição. Sites com essa caracteística permitem que a pessoa ou robô teste mais de uma predição caso o Captcha tenha fracassado. Como é possível observar na Tabela <a href="#tab:lista-captcha"><strong>??</strong></a>, dos 10 Captchas trabalhados, 7 permitem a realização desses testes.</p>
<p>Em teoria, a possibilidade de testar vários rótulos para o mesmo Captcha implica na possibilidade teórica de resolver um Captcha por força bruta. Bastaria testar todos os rótulos possíveis para acessar a página de interesse. Na prática, no entanto, essa estratégia não funciona, já que a quantidade de rótulos possíveis é muito grande para testar no site, seja por demorar muito tempo ou pelo site forçar a troca de Captcha após a passagem de determinado tempo ou quantidade de tentativas.</p>
<blockquote>
<p>Lista e caracterização dos captchas</p>
</blockquote>
<p>Além dos Captchas de sites, também consideramos imagens geradas artificialmente para rodar os modelos. O motivo de criar Captchas artificiais é a facilidade de rodar modelos e simulações, já que nos casos reais é necessário ter acesso à internet e também construir bases de dados de cada Captcha.</p>
<p>Existem duas alternativas ao Captcha gerado. O primeiro, chamado MNIST-Captcha, é simplesmente uma adaptação da conhecida base MNIST para ficar no formato de um Captcha. A partir da escolha do comprimento e dos caracteres que fazem parte da imagem, o gerador simplesmente faz uma amostra aleatória da base do MNIST e compõe as imagens horizontalmente.</p>
<p>A Figura <a href="#fig:captcha-mnist"><strong>??</strong></a> mostra um exemplo do Captcha gerado a partir da base MNIST. No exemplo, o comprimento escolhido para o Captcha foi de 4 valores.</p>
<p>O problema do MNIST-Captcha é que a base de dados original é finita. Apesar de possuir por volta de 60 mil observações e de um Captcha crescer em ordem exponencial, o MNIST-Captcha pode gerar Captchas repetidos. Além disso, é necessário tomar cuidado com as bases de treino e teste, já que os elementos de teste não poderiam fazer parte de nenhuma observação de treino.</p>
<p>Por esse motivo, criamos um Captcha interamente gerado por programação, chamado R-Captcha. O Captcha é gerado utilizando a ferramenta ImageMagick, com a possibilidade de customizar diversos parâmetros, como</p>
<ul>
<li>Quais caracteres usar na imagem</li>
<li>O comprimento do Captcha</li>
<li>Dimensões da imagem</li>
<li>Probabilidade de rotação da imagem</li>
<li>Probabilidade de adicionar um risco entre as letras</li>
<li>Probabilidade de adicionar uma borda nas letras</li>
<li>Probabilidade de adicionar uma caixa (retângulo) em torno das letras</li>
<li>Probabilidade de adicionar um ruído branco no fundo da imagem</li>
<li>Probabilidade de adicionar efeitos de tinta óleo e implosão</li>
</ul>
<p><img src="tese_files/figure-html/captcha-r-1.svg" width="864" /></p>
<p>Por ser uma versão mais flexível e completa, optamos por trabalhar principalmente com o R-Captcha nas simulações. O MNIST-Captcha foi implementado mas não foi utilizado nas simulações.</p>
<blockquote>
<p>Repositório de dados</p>
</blockquote>
<p>Os Captchas foram classificados com o procedimento que chamamos de semi-automático, definido a seguir. No pacote <code>{captchaDownload}</code>, foram desenvolvidas ferramentas para baixar e organizar cada Captcha, utilizando o oráculo para garantir que as imagens eram corretamente classificadas.</p>
<p>Cada Captcha teve as primeiras 100 observações classificadas manualmente. Isso foi feito a partir do próprio RStudio, utilizando a ferramenta de classificação manual do pacote <code>{captcha}</code>.</p>
<p>A partir das classificações iniciais, um modelo foi ajustado com a quantidade de observações disponível. Esse passo também foi feito a partir do pacote <code>{captcha}</code>, que cria um projeto de classificação para um Captcha específico.</p>
<p>O modelo, então, foi utilizado como uma ferramenta para otimizar a classificação manual, funcionando da seguinte forma. Primeiro, o modelo tenta realizar a predição automaticamente e o oráculo avisa se a predição está correta ou não. Se estiver incorreto, e o site aceitar várias tentativas, o modelo tenta novamente, mas com uma segunda alternativa de predição, definida por uma heurística, definida no Capítulo <a href="modelo.html#modelo">5</a>. Caso o site não aceite várias tentativas ou o modelo não consiga acertar o Captcha em <span class="math inline">\(N\)</span> tentativas (que arbitramos como dez), a imagem do Captcha aparecerá para classificação manual.</p>
<p>Com o procedimento destacado acima, é criada uma nova base de dados, que por sua vez é utilizada para ajustar um novo modelo. O modelo, atualizado, é utilizado para classificar novos Captchas, e assim por diante, até que o modelo ajustado alcance uma acurácia razoável, que arbitramos em 80%. Com isso, finalizamos o procedimento de classificação.</p>
<p>O único problema do procedimento de classificação diz respeito aos Captchas que não aceitam várias tentativas. Nesses casos, não é possível verificar com certeza absoluta que um caso classificado manualmente (após a tentativa do modelo) foi classificado corretamente, já que a classificação manual seria a segunda tentativa. No entanto, esse problema aparece somente em três Captchas (<code>cadesp</code>, <code>jucesp</code> e <code>trf5</code>). A classificação manual dos 100 primeiros Captchas, no entanto, mostrou que pelo menos 95% dos Captchas foram classificados corretamente quando classificados manualmente. Supomos que a proporção máxima de 5% de erro é negligenciável considerando que a maior parte das bases de dados foi construída com verificação do oráculo.</p>
<div id="simulações" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Simulações<a href="dados.html#simulações" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para verificar o poder do uso do oráculo para o aprendizado do modelo, recorremos a uma série de simulações. As simulações foram organizadas em três passos: modelo inicial, dados e modelo final. Os passos foram descritos em maior detalhe a seguir.</p>
<div id="primeiro-passo-modelo-inicial" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Primeiro passo: modelo inicial<a href="dados.html#primeiro-passo-modelo-inicial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A simulação do modelo inicial teve como objetivo obter modelos preditivos de Captchas com acurácias distintas. O modelo inicial seria usado, então, para baixar dados diretamente do site usando o oráculo e, por fim, ajustar um modelo final com os novos dados provenientes do oráculo.</p>
<p>Construímos os modelos iniciais em dois passos. O primeiro foi montar a base de dados completa, suficiente para ajustar um modelo com alta acurácia, que arbitramos em 80%, como descrito anteriormente. Depois, montamos 10 amostras de dados com subconjuntos das bases completas, cada uma contendo 10%, 20%, e assim por diante, até a base completa. Por exemplo: no Captcha da Jucesp, obtivemos um modelo com acurácia maior que 80% com 4000 Captchas. Fizemos então uma partição dos dados com 400 imagens (10% do total), 800 imagens (20% do total) e assim por diante, até o modelo com 4000 Captchas.</p>
<p>Para cada tamanho de amostra <span class="math inline">\(A\)</span>, rodamos uma bateria de 27 modelos. Fizemos isso porque para diferentes quantidades de amostra, a configuração dos hiperparâmetros que resulta no melhor modelo pode ser diferente. Fizemos uma grade de hiperparâmetros considerando três informações:</p>
<ul>
<li>A quantidade de unidades computacionais na primeira camada densa após as camadas convolucionais: consideramos os valores de 100, 200 e 300.</li>
<li>O valor do <em>dropout</em> aplicado às camadas densas: consideramos os valores de 10%, 30% e 50%.</li>
<li>O fator de decaimento na taxa de aprendizado a cada época: consideramos os valores de 1%, 2% e 3%.</li>
</ul>
<p>Combinando os três valores dos três hiperparâmetros, temos um total de <span class="math inline">\(27=3^3\)</span> hiperparâmetros. Com isso, foi possível identificar, para cada tamanho de amostra <span class="math inline">\(A\)</span>, o classificador <span class="math inline">\(C_A\)</span> com a melhor acurácia dentre os modelos ajustados.</p>
<p>No final do primeiro passo, portanto, consideramos apenas o melhor modelo para cada tamanho de amostra. É claro que os modelos encontrados por essa técnica não são, necessariamente, os melhor modelo possíveis. No entanto, como a técnica é a mesma para todos os Captchas, ganhamos a possibilidade de fazer comparações e temos uma metodologia mais transparente.</p>
</div>
<div id="segundo-passo-dados" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Segundo passo: dados<a href="dados.html#segundo-passo-dados" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>O segundo passo teve como objetivo construir as bases de dados utilizando o oráculo. Primeiro, foi necessário decidir quais modelos, dentre os 10 ajustados para cada Captcha, seriam utilizados para construir novas bases. Não faria sentido, por exemplo, considerar um modelo com acurácia de 0%, já que ele não produziria nenhuma observação comparado com um modelo que chuta aleatoriamente. Também não faria sentido considerar um classificador com acurácia de 100%, já que nesse caso não há o que testar com a técnica do oráculo.</p>
<p>Decidimos que seria necessário considerar somente os modelos que resultaram em acurácias maiores de 1% e menores de 50%. O valor máximo foi decidido após realizar alguns testes empíricos e verificar, informalmente, que a técnica do oráculo realmente resultava em ganhos expressivos, mesmo com modelos de baixa acurácia. Concluímos então que não seria necessário testar a eficácia da técnica para classificadores com alta acurácia. Já o valor mínimo foi decidido de forma arbitrária, retirando-se os classificadores com acurácia muito baixa.</p>
<p>A segunda decisão a ser tomada para construção dos dados foi a quantidade de imagens que seria baixada para cada Captcha. Como temos Captchas de diferentes dificuldades, a quantidade de dados seria diferente. Optamos por baixar a quantidade de dados de forma a montar uma base de treino que contém a quantidade de observações igual ao melhor modelo daquele Captcha. Por exemplo, no TJRS, um modelo com acurácia próxima de 100% foi identificado com 2000 observações. O melhor modelo com 300 imagens (240 para treino, 60 para teste) resultou em uma acurácia de 35%. Foram, então, baixadas 1760 observações para compor o total de 2000 na base de treino. As imagens de teste do modelo inicial poderiam até ser utilizadas, mas optamos por descartar para garantir que o modelo não ficasse sobreajustado para a primeira base.</p>
<p>O motivo de baixar a mesma quantidade de observações que o melhor modelo inicial foi feita por dois motivos. O primeiro é que temos evidências de que é possível construir um bom modelo com essa quantidade de imagens, ainda que em um caso tenhamos informações completas, e no outro incompletas. O segundo é que isso nos permite comparar o resultado do modelo completamente anotado contra o modelo que é parcialmente anotado e com anotações incompletas provenientes do oráculo.</p>
<p>A terceira e última decisão tomada para baixar os dados foi a quantidade de chutes que o modelo poderia fazer, nos casos em que isso é permitido pelo site. Optamos, de forma arbitrária, por três valores: 1, que é equivalente a um site que não permite múltiplos chutes, 5 chutes e 10 chutes.</p>
<p>Portanto, o procedimento de coleta dos dados foi feito, para cada Captcha, da seguinte forma:</p>
<ol style="list-style-type: decimal">
<li>Listamos todos os melhores modelos ajustados para cada tamanho de amostra.</li>
<li>Filtramos os modelos para os que apresentavam acurácia de 5% até 50%</li>
<li>Definimos o tamanho da base a ser obtida, com base no tamanho da base de treino utilizada no modelo e a quantidade total que se objetivou obter.</li>
<li>Para cada quantidade de tentativas disponível (1, 5 e 10), baixamos as imagens, classificando com o valor “1” se o Captcha fosse classificado corretamente em alguma das tentativas, e com o valor “0” caso contrário.</li>
<li>Nos casos com erros, armazenamos um arquivo de log para cada Captcha com o histórico de tentativas incorretas, que é a informação mais importante a ser passada do modelo final.</li>
</ol>
<p>No final, obtivemos bases de dados de treino para todos os Captchas analisados, com quantidades de imagens variadas de acordo com os parâmetros definidos anteriormente, variando também pela quantidade de tentativas. A quantidade total de bases de dados geradas foi 65.</p>
<p>Além das bases de treino, construímos, para cada Captcha, uma base de teste. As bases de teste foram construídas completamente do zero, sem utilizar informações de bases anteriores. Para construir as bases, utilizamos a mesma técnica semi-automática definida anteriormente, usando o melhor modelo disponível para classificar a maioria das imagens e classificando manualmente em caso de falha. Em alguns casos, como TJMG e TJRS, a classificação humana quase não foi necessária, pois os classificadores obtidos apresentaram acurácia próxima de 100%.</p>
<p>Como o único objetivo da base de teste foi o de estimar a acurácia dos modelos finais, a quantidade de observações poderia ser arbitrada. O tamanho das bases de teste foi, então, arbitrado em 1000 imagens para todos os Captchas.</p>
</div>
<div id="terceiro-passo-modelo-final" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Terceiro passo: modelo final<a href="dados.html#terceiro-passo-modelo-final" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>O modelo final foi ajustado para cada uma das 65 bases de treino disponíveis após a realização dos passos 1 e 2. Nesse caso, utilizamos o modelo proposto, que considera os erros na verossimilhança do modelo. Caso a imagem tenha sido corretamente classificada, a função de perda é calculada normalmente. Caso ela tenha sido classificada incorretamente, consideramos na verossimilhança a probabilidade de não observar nenhum dos chutes.</p>
<p>Exemplo. Considere um Captcha com letras e números como vocabulário e comprimento de 4 valores. Uma imagem apresenta o rótulo (correto) “zab2”. O classificador do passo inicial tentou as seguintes configurações: “zab5”, “sab2”, “sab5”, “zob2”, “zob5”, todas erradas. A probabilidade considerada na verossimilhança para essa imagem é, portanto:</p>
<p><span class="math display">\[
P = 1 - p(\text{zab5})- p(\text{sab2})- p(\text{sab5})- p(\text{zob2})- p(\text{zob5})
\]</span></p>
<p>Além de modificar a forma de calcular a função de perda do modelo, foi necessário testar os hiperparâmetros. Optamos por utilizar os mesmos hiperparâmetros dos modelos iniciais para manter a consistência. O único detalhe nesse ponto é que, como partimos dos parâmetros do modelo inicial, optamos por não modificar a quantidade de unidades na camada densa, variando somente os valores de <em>dropout</em> e de decaimento na taxa de aprendizado. Portanto, ajustamos 9 e não 27 modelos para cada base de dados.</p>
<p>No final, assim como no primeiro passo, selecionamos classificador com melhor acurácia para cada modelo. Ficamos, então, com 65 modelos no final para comparar com os modelos iniciais e estimar a efetividade do oráculo. As comparações foram feitas através de gráficos de barras, explorando o efeito do uso do oráculo para diferentes Captchas, diferentes modelos iniciais e diferentes quantidades de chutes, além de um gráfico de dispersão para relacionar as acurácias iniciais e finais.</p>
<p>Além do terceiro passo, fizemos alguns experimentos para verificar se, ao aplicar a técnica do oráculo iterativamente, poderíamos obter melhores resultados. Ou seja, podemos considerar os modelos obtidos no passo 3 como os modelos iniciais do passo 1, aplicar novamente o passo 2 (baixar dados) e o passo 3 (rodar modelo com os novos dados). Isso foi feito para apenas um conjunto selecionado de Captchas para verificar essa possibilidade, não fazendo parte das simulações principais deste estudo.</p>
<blockquote>
<p>Contribuições da comunidade</p>
</blockquote>
<blockquote>
<p>App {ancaptcha}</p>
</blockquote>

<p><span class="math display">\[\newcommand{\x}{\mathbf{x}}
\newcommand{\X}{\mathbf{X}}
\renewcommand{\s}{\mathbf{s}}
\renewcommand{\S}{\mathbf{S}}
\renewcommand{\Z}{\mathbf{Z}}
\renewcommand{\z}{\mathbf{z}}
\newcommand{\w}{\mathbf{w}}
\renewcommand{\P}{\mathbb{P}}
\renewcommand{\tt}{\boldsymbol{\theta}}\]</span></p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="captchas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["tese.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
